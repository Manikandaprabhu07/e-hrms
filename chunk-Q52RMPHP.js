import{b as V,c as m,d as I,e as L,g as q,i as T,j as z,p as G,q as U,r as D}from"./chunk-A5QHFWYL.js";import{A,B as N,c as O,h as x,v as k}from"./chunk-WMLRWR2K.js";import{Ha as F,M as f,Ma as g,Xa as o,Ya as n,Za as t,_a as u,eb as c,ob as r,qb as p,rb as M,ta as i}from"./chunk-6BNDL2TO.js";import"./chunk-7CGTOI24.js";function H(a,s){a&1&&(n(0,"span",23),r(1," Current password is required "),t())}function j(a,s){a&1&&(n(0,"span",23),r(1," New password is required "),t())}function B(a,s){a&1&&(n(0,"span",23),r(1," Password must be at least 8 characters "),t())}function J(a,s){a&1&&(n(0,"span",23),r(1," Confirm password is required "),t())}function K(a,s){a&1&&(n(0,"span",23),r(1," Passwords do not match "),t())}function Q(a,s){a&1&&(n(0,"span",23),r(1," New email is required "),t())}function W(a,s){a&1&&(n(0,"span",23),r(1," Please enter a valid email address "),t())}function X(a,s){a&1&&(n(0,"span",23),r(1," Password is required "),t())}var R=class a{authService=f(A);notificationService=f(N);router=f(k);fb=f(G);changePasswordForm;changeEmailForm;isChangingPassword=!1;isChangingEmail=!1;passwordVisible=!1;confirmPasswordVisible=!1;currentUser=this.authService.user;isLoading=this.authService.isLoading;constructor(){this.initializeForms()}initializeForms(){this.changePasswordForm=this.fb.group({currentPassword:["",[m.required,m.minLength(6)]],newPassword:["",[m.required,m.minLength(8)]],confirmPassword:["",m.required]},{validators:this.passwordMatchValidator}),this.changeEmailForm=this.fb.group({newEmail:["",[m.required,m.email]],password:["",[m.required,m.minLength(6)]]})}passwordMatchValidator(s){let l=s.get("newPassword")?.value,e=s.get("confirmPassword")?.value;return l&&e&&l!==e?{passwordMismatch:!0}:null}togglePasswordVisibility(){this.passwordVisible=!this.passwordVisible}toggleConfirmPasswordVisibility(){this.confirmPasswordVisible=!this.confirmPasswordVisible}async onChangePassword(){if(this.changePasswordForm.invalid){this.notificationService.error("Please fill in all required fields correctly");return}this.isChangingPassword=!0;try{await this.authService.changePassword({currentPassword:this.changePasswordForm.value.currentPassword,newPassword:this.changePasswordForm.value.newPassword,confirmPassword:this.changePasswordForm.value.confirmPassword}),this.notificationService.success("Password changed successfully. Please login again."),this.changePasswordForm.reset(),setTimeout(()=>{this.authService.logout()},2e3)}catch(s){let l=s.error?.message||"Failed to change password";this.notificationService.error(l)}finally{this.isChangingPassword=!1}}async onChangeEmail(){if(this.changeEmailForm.invalid){this.notificationService.error("Please fill in all required fields correctly");return}this.isChangingEmail=!0;try{await this.authService.changeEmail({newEmail:this.changeEmailForm.value.newEmail,password:this.changeEmailForm.value.password}),this.notificationService.success("Email changed successfully"),this.changeEmailForm.reset()}catch(s){let l=s.error?.message||"Failed to change email";this.notificationService.error(l)}finally{this.isChangingEmail=!1}}resetPasswordForm(){this.changePasswordForm.reset(),this.passwordVisible=!1,this.confirmPasswordVisible=!1}resetEmailForm(){this.changeEmailForm.reset()}static \u0275fac=function(l){return new(l||a)};static \u0275cmp=F({type:a,selectors:[["app-account-settings"]],decls:71,vars:31,consts:[[1,"account-settings-container"],[1,"user-info-section"],[1,"user-details"],[1,"settings-section","change-password-section"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","currentPassword"],["type","password","id","currentPassword","formControlName","currentPassword","placeholder","Enter your current password",1,"form-control",3,"disabled"],["class","error-message",4,"ngIf"],["for","newPassword"],[1,"password-input-wrapper"],["id","newPassword","formControlName","newPassword","placeholder","Enter a new password (min 8 characters)",1,"form-control",3,"type","disabled"],["type","button",1,"toggle-password",3,"click","disabled"],["for","confirmPassword"],["id","confirmPassword","formControlName","confirmPassword","placeholder","Confirm your new password",1,"form-control",3,"type","disabled"],[1,"form-actions"],["type","submit",1,"btn","btn-primary",3,"disabled"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],[1,"settings-section","change-email-section"],["for","newEmail"],["type","email","id","newEmail","formControlName","newEmail","placeholder","Enter your new email address",1,"form-control",3,"disabled"],["for","emailPassword"],["type","password","id","emailPassword","formControlName","password","placeholder","Enter your password to confirm email change",1,"form-control",3,"disabled"],[1,"error-message"]],template:function(l,e){if(l&1&&(n(0,"div",0)(1,"h1"),r(2,"Account Settings"),t(),n(3,"div",1)(4,"h2"),r(5,"Current Account"),t(),n(6,"div",2)(7,"p")(8,"strong"),r(9,"Name:"),t(),r(10),t(),n(11,"p")(12,"strong"),r(13,"Email:"),t(),r(14),t(),n(15,"p")(16,"strong"),r(17,"Username:"),t(),r(18),t()()(),n(19,"div",3)(20,"h2"),r(21,"Change Password"),t(),n(22,"form",4),c("ngSubmit",function(){return e.onChangePassword()}),n(23,"div",5)(24,"label",6),r(25,"Current Password *"),t(),u(26,"input",7),g(27,H,2,0,"span",8),t(),n(28,"div",5)(29,"label",9),r(30,"New Password *"),t(),n(31,"div",10),u(32,"input",11),n(33,"button",12),c("click",function(){return e.togglePasswordVisibility()}),r(34),t()(),g(35,j,2,0,"span",8)(36,B,2,0,"span",8),t(),n(37,"div",5)(38,"label",13),r(39,"Confirm Password *"),t(),n(40,"div",10),u(41,"input",14),n(42,"button",12),c("click",function(){return e.toggleConfirmPasswordVisibility()}),r(43),t()(),g(44,J,2,0,"span",8)(45,K,2,0,"span",8),t(),n(46,"div",15)(47,"button",16),r(48),t(),n(49,"button",17),c("click",function(){return e.resetPasswordForm()}),r(50," Reset "),t()()()(),n(51,"div",18)(52,"h2"),r(53,"Change Email Address"),t(),n(54,"form",4),c("ngSubmit",function(){return e.onChangeEmail()}),n(55,"div",5)(56,"label",19),r(57,"New Email Address *"),t(),u(58,"input",20),g(59,Q,2,0,"span",8)(60,W,2,0,"span",8),t(),n(61,"div",5)(62,"label",21),r(63,"Password (for verification) *"),t(),u(64,"input",22),g(65,X,2,0,"span",8),t(),n(66,"div",15)(67,"button",16),r(68),t(),n(69,"button",17),c("click",function(){return e.resetEmailForm()}),r(70," Reset "),t()()()()()),l&2){let d,E,y,w,h,P,b,S,_,C,v;i(10),M(" ",(d=e.currentUser())==null?null:d.firstName," ",(d=e.currentUser())==null?null:d.lastName),i(4),p(" ",(E=e.currentUser())==null?null:E.email),i(4),p(" ",(y=e.currentUser())==null?null:y.username),i(4),o("formGroup",e.changePasswordForm),i(4),o("disabled",e.isLoading()),i(),o("ngIf",((w=e.changePasswordForm.get("currentPassword"))==null?null:w.hasError("required"))&&((w=e.changePasswordForm.get("currentPassword"))==null?null:w.touched)),i(5),o("type",e.passwordVisible?"text":"password")("disabled",e.isLoading()),i(),o("disabled",e.isLoading()),i(),p(" ",e.passwordVisible?"Hide":"Show"," "),i(),o("ngIf",((h=e.changePasswordForm.get("newPassword"))==null?null:h.hasError("required"))&&((h=e.changePasswordForm.get("newPassword"))==null?null:h.touched)),i(),o("ngIf",((P=e.changePasswordForm.get("newPassword"))==null?null:P.hasError("minlength"))&&((P=e.changePasswordForm.get("newPassword"))==null?null:P.touched)),i(5),o("type",e.confirmPasswordVisible?"text":"password")("disabled",e.isLoading()),i(),o("disabled",e.isLoading()),i(),p(" ",e.confirmPasswordVisible?"Hide":"Show"," "),i(),o("ngIf",((b=e.changePasswordForm.get("confirmPassword"))==null?null:b.hasError("required"))&&((b=e.changePasswordForm.get("confirmPassword"))==null?null:b.touched)),i(),o("ngIf",e.changePasswordForm.hasError("passwordMismatch")&&((S=e.changePasswordForm.get("confirmPassword"))==null?null:S.touched)),i(2),o("disabled",e.changePasswordForm.invalid||e.isLoading()),i(),p(" ",e.isLoading()?"Changing Password...":"Change Password"," "),i(),o("disabled",e.isLoading()),i(5),o("formGroup",e.changeEmailForm),i(4),o("disabled",e.isLoading()),i(),o("ngIf",((_=e.changeEmailForm.get("newEmail"))==null?null:_.hasError("required"))&&((_=e.changeEmailForm.get("newEmail"))==null?null:_.touched)),i(),o("ngIf",((C=e.changeEmailForm.get("newEmail"))==null?null:C.hasError("email"))&&((C=e.changeEmailForm.get("newEmail"))==null?null:C.touched)),i(4),o("disabled",e.isLoading()),i(),o("ngIf",((v=e.changeEmailForm.get("password"))==null?null:v.hasError("required"))&&((v=e.changeEmailForm.get("password"))==null?null:v.touched)),i(2),o("disabled",e.changeEmailForm.invalid||e.isLoading()),i(),p(" ",e.isLoading()?"Changing Email...":"Change Email"," "),i(),o("disabled",e.isLoading())}},dependencies:[x,O,U,q,V,I,L,D,z,T],styles:[".account-settings-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:2rem}h1[_ngcontent-%COMP%]{color:#333;margin-bottom:2rem;font-size:2rem}h2[_ngcontent-%COMP%]{color:#555;margin-bottom:1.5rem;font-size:1.5rem;border-bottom:2px solid #007bff;padding-bottom:.5rem}.user-info-section[_ngcontent-%COMP%]{background:#f8f9fa;padding:1.5rem;border-radius:8px;margin-bottom:2rem;border-left:4px solid #007bff}.user-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.5rem 0;font-size:1rem;color:#555}.user-details[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#333;font-weight:600}.settings-section[_ngcontent-%COMP%]{background:#fff;padding:2rem;border-radius:8px;border:1px solid #ddd;margin-bottom:2rem;box-shadow:0 2px 4px #0000000d}.settings-section[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#333;font-size:.95rem}.form-control[_ngcontent-%COMP%]{padding:.75rem;border:1px solid #ddd;border-radius:4px;font-size:1rem;font-family:inherit;transition:border-color .2s,box-shadow .2s}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff;box-shadow:0 0 0 3px #007bff1a}.form-control[_ngcontent-%COMP%]:disabled{background-color:#f0f0f0;cursor:not-allowed;color:#999}.password-input-wrapper[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.password-input-wrapper[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{flex:1}.toggle-password[_ngcontent-%COMP%]{padding:.75rem 1rem;background:#f0f0f0;border:1px solid #ddd;border-radius:4px;cursor:pointer;white-space:nowrap;font-size:.85rem;transition:background-color .2s}.toggle-password[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#e0e0e0}.toggle-password[_ngcontent-%COMP%]:disabled{cursor:not-allowed;color:#999}.error-message[_ngcontent-%COMP%]{color:#dc3545;font-size:.85rem;margin-top:.25rem}.form-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-top:1rem}.btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;border-radius:4px;cursor:pointer;font-size:1rem;font-weight:600;transition:background-color .2s,opacity .2s}.btn-primary[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#0056b3}.btn-primary[_ngcontent-%COMP%]:disabled{background-color:#6c757d;cursor:not-allowed;opacity:.65}.btn-secondary[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#545b62}.btn-secondary[_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.65}@media(max-width:768px){.account-settings-container[_ngcontent-%COMP%]{padding:1rem}h1[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:1.5rem}h2[_ngcontent-%COMP%]{font-size:1.25rem;margin-bottom:1rem}.settings-section[_ngcontent-%COMP%]{padding:1.5rem}.form-actions[_ngcontent-%COMP%]{flex-direction:column}.btn[_ngcontent-%COMP%]{width:100%}.password-input-wrapper[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.toggle-password[_ngcontent-%COMP%]{width:100%;text-align:center}}"]})};export{R as AccountSettingsComponent};
